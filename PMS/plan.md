# 计划管理系统 (Plan Management System) 策划方案 v2.0

## 项目愿景

构建一个适配企业组织架构、覆盖任务全生命周期的轻量级管理工具。通过精细化的任务属性管理与多维度绩效算法，解决“计划执行难跟踪、绩效评价主观化”的问题。
用户规模：<50人

## 核心功能模块

### 任务录入与结构化管理 (Input & Structure)

1. 录入： 参考ios的待办清单，可以快速录入相关内容 ✅
2. 录入权限：主管录入的计划，按要求执行。负责人也可以录入计划，经主管审批后执行。 ✅
3. 任务拆解 (Sub-tasks)： 支持主任务下设多个子任务（类似 iOS 待办清单），子任务可独立分配实施人与截止日期。在创建子任务时提供一个可选的“权重比”，默认均分。如果设定了权重，则按权重计算主任务进度。
4. 岗位分配逻辑： 任务不仅分配给个人，还可关联岗位。特定岗位（如“主管”、“中心主任”）具备任务分发与转办权限。
5. 任务分配到具体人员后开始执行，负责人如果是主管、可以再分配。在任务转移时，系统应提示主管手动或根据当前进度自动锁定“已完成部分的积分”，将剩余部分的“基础分”流转给接手人。
6. 若计划无法完成，可以转移相应人员执行，过程应被记录和评价

精细化属性 (核心)： | 字段类别 | 具体字段内容 | | :--- | :--- | | 分类体系 | 计划分类、小类、特殊标记（如：待确认、紧急、阶段性） | | 内容定义 | 计划事项、具体要求（遵循 5W2H / SMART 原则）、单位 | | 责任矩阵 | 编制人、负责人、实施人（支持按岗位/部门选择） | | 时间维度 | 计划开始时间、计划完成时间、工期、持续天数、剩余天数、实际完成时间 | | 进度动态 | 完成进展（实时更新流，支持记录历史动态）、完成情况、备注 | | 系统判断 | 超期情况（自动计算，如“超期 5 倍”等逻辑） |

### 流程循环

1. 任务全生命周期状态机 (State Machine)
这是系统后台逻辑的核心，决定了任务在什么阶段可以做什么操作。
草稿 (Draft)： 负责人/主管填写中，仅自己可见。 ✅
待审批 (Pending Approval)： 负责人录入后，提交给主管定级（I 和 D）。 ✅
进行中 (In-Progress)： 审批通过，实施人收到提醒，开始计时。此阶段可更新“完成进展”。 ✅
待验收 (Pending Review)： 实施人点选“完成”并上传证据（超链接），系统停止计时。 ✅
已完成 (Completed)： 主管评分（Q）并归档，分值入库。 ✅
已驳回 (Rejected)： 主管认为完成质量不合格，退回“进行中”，工期不重置（会导致超期）。
已取消/挂起： 外部因素导致任务终止。

2. 权限与任务流转 (Role-Based Flow)
明确“谁在哪个环节介入”。
下达流： 主管 → 负责人 → 实施人。主管可以直接指派，也可以指派给负责人，由负责人二次拆解子任务。
反馈流： 实施人更新进展 → 负责人/主管实时收到推送。
申诉流： 红牌触发 → 实施人发起申诉 → 管理员/上一级主管介入裁决。

3. 子任务加权聚合逻辑
系统如何自动计算主任务的进度？
逻辑： 主任务进度 = ∑(子任务 n进度×权重 n)。
管控点： 只有当 ∑子任务已完成时，主任务的状态位才允许切换至“待验收”。

### 过程跟踪与协作 (Tracking)

动态状态机： 未开始、进行中、待验收、已完成、延期、挂起、取消
全历程日志： 自动记录任务从“发布-接收-进展更新-验收”的每一个时间戳及操作人。任务执行过程中可以不断填写更新完成情况日志，便于查看和反馈。
轻量化评价/备注： 执行过程中的关键证据（如文档、图片）以超链接形式挂载在任务进展中。
任务需及时反馈，需经过确认才认可完成情况

### 组织架构与权限 (User Management)

多级层级结构：
公司层级： 总揽全局数据。
部门层级： 管理部门内计划流转。
岗位/人员层级： 明确“主管”与“执行人员”的上下级汇报关系。
权限控制 (RBAC)： * Admin: 系统参数（计划分类、岗位定义、绩效算法）配置。
Manager: 计划下达、审核验收、下属绩效统计。
Staff: 录入计划、更新进度、反馈阻塞问题。
审核权限： 由对应的 Manager 或 Admin 进行一键审核。
系统留痕： 无论申诉成功与否，申诉过程中的证据和回复都永久挂载在该任务的“全历程日志”中，作为年度复盘的依据。
如果申诉成功是因为“前序任务阻塞”，系统应考虑是否将红牌自动关联到导致阻塞的前序任务负责人身上。

### 分析与绩效引擎 (Analytics & KPI)

1. 风险预警： 自动红标显示超期或进度滞后的任务。 ✅
2. 绩效算法 (核心)： 引入难度系数，使评价更公平。 ✅
3. 报表中心： 一键生成个人/部门的周报、月报，支持导出 Excel/PDF。
4. 看板维度：
    - 准时率雷达图： 综合反映员工的可靠度。
    - 难度贡献榜： 展示谁承接了最难的任务（难度系数加权后的总分）。
    - 阻塞热力图： 分析哪些环节（或岗位）最容易发生延期，便于你进行流程优化。
5. 实现“全文索引”+“标签过滤”。
    - 支持搜索：负责人:杨杰 状态:进行中 关键字:应急。
    - 这样在进行月度例会时，你可以秒级调出所有“待确认”或“风险”任务。

### 数据安全与持久化 (Security)

存储： 采用 Web 服务器后端数据库存储。
备份： 支持定期自动备份，用户可手动导出 JSON/CSV 格式的全量数据。
数据备份： 配置一个自动任务，每天定时将数据库 Dump 文件同步到 NAS 的另一个物理盘或云端，确保你要求的“数据永久保存”。

## 3 技术路线

采用 Tailwind CSS 进行响应式开发。
架构类型： Web 前后端分离架构。
前端： Vue 3 + Vite
后端： Python (Django/FastAPI)
数据库： PostgreSQL。
移动端：做成 PWA (Progressive Web App)
通知推送方式：登陆系统后查看，其他推送以后再说

## 4 绩效评价逻辑 (Evaluation Logic)

### 系统采用加权积分制，公式设计如下

每个进入系统的“计划事项”需根据以下公式计算最终得分 (S)：
S=max(0,(B×I×D)×Q×T−P)
如果实际完成小于计划完成时间，T=1；如果实际大于计划完成时间，$$T = \begin{cases} 1.0, & \Delta t \le 0 \\ \max \left( 0.2, 1.0 - \frac{\Delta t}{D} \cdot f \right), & \Delta t > 0 \end{cases}$$
参数说明：
B (Base Value): 任务基准分（建议统一设定为 100）。
I (Importance): 重要性系数。
D (Difficulty): 难度系数。0.8 - 1.5（在任务发布时由 Manager 设定）。
Q (Quality): 质量系数 (0.0 - 1.2)。（验收时由 Manager 根据交付成果评分）。
T (Timeliness): 时效系数 (0.0 - 1.0)。 提前/准时完成： 1.0；超期完成： 1.0−(超期天数/总工期)×惩罚因子（最低不低于 0.2）。
P (Penalty): 考核扣分（红牌触发）。
指标设定维度 (Metrics Definition)
排除简单任务，我们对 I 和 D 进行等级定义，只有达到特定等级的任务才进入绩效池。
分类管理： 录入时增加“任务类型”标签。类型为“日常/行政”的任务不展示 I 和 D 选项，直接转入“工作日志”模块，仅作存证，不参与积分计算。
准入规则： 只有 I×D>0.5 的任务才会出现在人员绩效榜单中。
    - 封顶限制： 质量系数最高 1.2（代表卓越完成），时效系数最高 1.0。这意味着单个任务的最高得分不会超过 W×D×1.2。
    - 分值预测（预览制）： 在任务执行过程中，Staff 可以实时看到自己的“当前预计得分”。如果已经逾期，系统会实时扣减“时效系数”，直观的压力能更好地推动执行。
    - 系数微调： Admin 可以在后台根据年度/季度管理目标的侧重点（如：本季度重“安全质量”，下季度重“抢工期”），动态调整惩罚因子或质量权重的范围。
主任务的进度由子任务加权自动计算。
    - 如果主任务下有 5 个子任务，每个子任务完成，主任务进度自动增加 20%。
    - 只有所有子任务全部“已完成”，主任务才允许进入“待验收”状态。

### “红黄牌触发器” 逻辑

    - 黄牌（预警）： 距离截止时间仅 24 小时且进度 < 50%，系统自动推送通知给负责人和主管。
    - 红牌（考核）： 任务逾期超过 3 天或“超期倍数”达到 1 倍。
    - 自动处理： 触发红牌后，系统自动生成一条“考核单”，扣除当月绩效基分，并要求负责人填写“原因分析”，该记录永久挂载在任务日志中。

### 申诉与管控逻辑

初始定分权： 任务下达时，由 Manager 设定 I 和 D。Staff 接收时如有异议，可即时发起“定级沟通”。
强制评价： 若任务状态变为“已完成”，Manager 必须在 48 小时内给出 Q 值，否则系统按 Q=1.0 自动封账，确保数据时效性。
考核单关联： 红牌触发后的 P 值（罚分）直接从当月总得分中减去。如果 P 导致月度得分为负，系统自动将差额滚动到下月，实现持续压力。
自动生成考核单： 当“红牌”触发时，系统自动在用户的“个人中心”生成一条申诉入口，有效期建议设为 48小时。
申诉状态机： 待申诉 -> 申诉中 -> 已撤回考核 / 申诉被驳回。
申诉所需材料（5W2H 证据链）
证明文件： 允许上传截图、照片、通话记录、说明文件等。选择申诉原因。

### 指标说明

绩效 KPI 指标转化
原始积分需转化为管理层可看懂的指标（KPI）：

个人贡献度 (Personal Contribution):
公式：个人总分/部门总分×100%
用途：体现谁承载了部门最核心、最难的工作。

任务交付效率 (Timeliness Index):
公式：平均时效系数
参数说明：
变量,含义,计算逻辑 / 备注
Δt,超期时长,实际完成时间−计划完成时间
D,计划总工期,计划完成时间−计划开始时间
f,惩罚因子,默认为 1.0，值越大逾期扣分越快
0.2,保底系数,确保严重超期的任务依然有 20% 的时效基分，防止执行人由于逾期过久而彻底放弃任务进度
用途：衡量员工是否存在拖延习惯。

交付质量方差 (Quality Stability):
公式：质量系数 Q 的标准差
用途：判断员工发挥是否稳定，是否经常需要“返工”。

考核触发率 (Red Card Rate):
公式：红牌任务数/总任务数
用途：作为负面指标，直接挂钩年度评优“一票否决”。

## UI

1. UI同时支持 PC端和移动端
2. PC端： 侧重于**“大表管理”和“统计看板”**，利用宽屏展示 2.1 节中那个复杂的任务属性表。
3. 移动端： 侧重于**“反馈与提醒”**。不要强行展示长表格，而是采用“卡片式”流转。
4. 使用UI-UX技能优化UI

## 部署

1. 部署到nas或者vps
   - 编写 Docker Compose 脚本。
   - 一键拉起 FastAPI + PostgreSQL + Redis 环境。除了常规缓存，Redis 可以用来处理“红黄牌”的定时检查任务
   - 在 NAS 上通过 Docker 部署时，确保配置好 HTTPS（可以使用 Nginx Proxy Manager），因为 PWA 的核心功能（如离线访问和桌面通知）强制要求在安全链接下运行

## 说明帮助系统

1. 完善的说明系统，引导用户使用
2. 明确各个指标

## 规划功能

申诉的评判做成AI skill
