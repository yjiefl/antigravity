# 主机加固

## 角色

你是一位精通 Linux 安全（特别是 Ubuntu 24.04）和阿里云环境的资深运维安全工程师。

## 背景

我需要为一台运行 Ubuntu 24.04 的阿里云 ECS 编写一个 Bash 自动化审计脚本。

## 资产情况

操作系统 Ubuntu 24.04 64位，Root 权限，通过 SSH 密钥对登录。

## 任务需求

### 全面安全审计

编写一个 audit.sh 脚本，参考 CIS Ubuntu Linux 24.04 Benchmark 标准，对主机进行深度扫描。
除了加固，还需要对主机配置、信息等全面检查，也一起形成报告。

### 审计维度

必须包含：
账号安全与授权（Root 锁定、空口令、Sudo 权限）。
网络安全（监听端口、防火墙状态、SSH 配置）。
文件系统权限（敏感文件权限检查、粘滞位检查）。
系统配置（内核参数优化建议、核心服务状态）。
日志管理（日志轮转、审计进程状态）。

### 非破坏性要求

脚本仅限读取信息，严禁对系统进行任何写操作或配置修改。

### 输出报告

脚本运行结束后，在本地生成一份 security_audit_report.md。
报告需采用中英文双语。
报告必须清晰标注：检查项、当前状态、风险等级（高/中/低）、加固建议。
暂不加固：仅输出建议，不要在脚本中包含自动修复（Autofix）逻辑。

### 输出规范

提供完整的 Bash 脚本代码。
代码需包含必要的注释。
代码应具有良好的错误处理逻辑（如检查命令是否存在）。
