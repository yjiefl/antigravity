# 可用功率指标计算 - 测试方案

本文档详细描述了针对《可用功率指标计算.md》中新增逻辑的测试用例设计与验证方法。

## 一、 测试范围

本次测试重点验证以下两个新增逻辑点：

1. **受限时段判定逻辑**：
    * **风电**：全天纳入受限统计。
    * **光伏**：仅 06:00 - 20:00 纳入受限统计。

2. **全天不受限时长校验**：
    * 统计全天“未受限”的总时长。
    * **风电**：若未受限时长 < 1.5 小时，则全天曲线不修正。
    * **光伏**：若未受限时长 < 1.0 小时，则全天曲线不修正。

---

## 二、 测试用例设计 (Test Cases)

### 场景 1：光伏场站 - 受限时段过滤

| 用例编号 | 场景描述 | 输入数据 (示例) | 预期结果 | 备注 |
| :--- | :--- | :--- | :--- | :--- |
| **TC-01** | 光伏夜间限电 | 05:30 标记为限电 | **不计入**受限时长 | 06:00 前不考虑 |
| **TC-02** | 光伏清晨限电 | 06:15 标记为限电 | **计入**受限时长 | 06:00 后考虑 |
| **TC-03** | 光伏傍晚限电 | 19:45 标记为限电 | **计入**受限时长 | 20:00 前考虑 |
| **TC-04** | 光伏夜间限电 | 20:15 标记为限电 | **不计入**受限时长 | 20:00 后不考虑 |

### 场景 2：风电场站 - 全天受限

| 用例编号 | 场景描述 | 输入数据 (示例) | 预期结果 | 备注 |
| :--- | :--- | :--- | :--- | :--- |
| **TC-05** | 风电凌晨限电 | 02:00 标记为限电 | **计入**受限时长 | 风电全天考虑 |
| **TC-06** | 风电深夜限电 | 23:00 标记为限电 | **计入**受限时长 | 风电全天考虑 |

### 场景 3：最小不受限时长校验

| 用例编号 | 场景描述 | 输入数据 (未受限累计时长) | 预期结果 | 备注 |
| :--- | :--- | :--- | :--- | :--- |
| **TC-07** | 风电 - 不足 1.5h | Total Unrestricted = 1.4h | **不修正**曲线 | 阈值 1.5h |
| **TC-08** | 风电 - 满足 1.5h | Total Unrestricted = 1.5h | **修正**曲线 | 边界值覆盖 |
| **TC-09** | 光伏 - 不足 1.0h | Total Unrestricted = 0.9h | **不修正**曲线 | 阈值 1.0h |
| **TC-10** | 光伏 - 满足 1.0h | Total Unrestricted = 1.0h | **修正**曲线 | 边界值覆盖 |

---

## 三、 自动化测试脚本

可以使用提供的 Python 脚本 `test_available_power.py` 进行逻辑验证。

### 运行方式

```bash
python3 test_available_power.py
```

该脚本模拟了上述测试场景，并输出 Pass/Fail 结果。
