# Agent Git 操作与项目管理指引

## 1. 项目结构规范

- 本项目采用 Monorepo（单体大仓库）结构，根目录为 `antigravity`。
- **严禁**在任何子目录下执行 `git init` 或创建独立的 `.git` 文件夹。
- 所有的功能模块（如：电气操作管理、储能自动调节系统等）均作为子文件夹管理，不得作为独立仓库推送。

## 2. 版本管理流程

- **开始任务前**：必须首先执行 `git pull origin main`，确保获取多台电脑同步后的最新代码。
- **开发过程中**：每完成一个独立的逻辑功能，应进行一次小额提交（Atomic Commit），提交信息需清晰描述改动。
- **任务结束/切换电脑前**：
    1. 运行 `git status` 检查状态。
    2. 执行 `git add .` 和 `git commit`。
    3. 必须执行 `git push origin main` 将进度同步至 GitHub。
    4. 在 `README.md` 或进度记录中简要总结当前状态，方便在另一台电脑继续工作。

## 3. 冲突与安全

- 若遇到合并冲突，Agent 必须停止自动操作并向用户报告，严禁强制覆盖代码。
- 严格遵守 `.gitignore` 规则，严禁上传 `__pycache__`、`.venv` 或临时 Excel 文件。

## 4. 自动化同步工具

- 本项目提供 `git_sync.sh` 脚本用于快速同步：

    ```bash
    ./git_sync.sh
    ```

- 该脚本会自动执行：`git pull` -> `git add .` -> `git commit` (仅在有变动时) -> `git push`。
- 若同步过程中发现冲突，脚本会立即停止并提示处理。
- **发布版本**：
  - 运行 `./git_sync.sh -t` 或在菜单中选择 `5. 创建Release`。
  - 该功能不仅会创建并推送本地 Git Tag，还会自动通过 `gh` CLI 创建正式的 **GitHub Release**（会显示在仓库首页右侧）。
  - 脚本会自动尝试从远程 URL 获取 Token 进行认证，无需手动登录。
  - 支持选择是否同步应用到所有嵌套仓库（仅打 Tag，不创建 Release）。
